<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicon.ico" /><title>Bypass NAC ( Network Access Control ) - Curriculum / 0xbaadf00d</title><meta name="author" content="Rodolfo Tavares" /><meta name="description" content="Bypass NAC ( Network Access Control )" /><meta name="keywords" content="Bypass NAC ( Network Access Control ), Curriculum / 0xbaadf00d, hacking" /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="Curriculum / 0xbaadf00d" property="og:site_name"><meta content="Bypass NAC ( Network Access Control )" property="og:title"><meta content="article" property="og:type"><meta content="Computer skills by Rodolfo Tavares" property="og:description"><meta content="https://0xrdf.github.io/hacking/2020/02/02/bypass-nac.html" property="og:url"><meta content="2020-02-02T17:12:34-03:00" property="article:published_time"><meta content="https://0xrdf.github.io/about/" property="article:author"><meta content="https://0xrdf.github.io/static/img/avatar.png" property="og:image"><meta content="hacking" property="article:section"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@0xrdf0"><meta name="twitter:creator" content="@0xrdf0"><meta name="twitter:title" content="Bypass NAC ( Network Access Control )"><meta name="twitter:url" content="https://0xrdf.github.io/hacking/2020/02/02/bypass-nac.html"><meta name="twitter:description" content="Computer skills by Rodolfo Tavares"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-XXXXXXXX-Y', 'auto'); ga('send', 'pageview'); </script><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.png" height="75px" width="75px" /></a><h1 class="author-name">Rodolfo Tavares</h1><div class="profile-about"> I am a pentester and mobile security researcher. Also, play CTF's</div><div class="social"><ul><li><a href="https://twitter.com/0xrdf0" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.linkedin.com/in/rodolfo-augusto-543863a/" target="_blank"><i class="fa fa-linkedin"></i></a><li><a href="https://github.com/0xrdf" target="_blank"><i class="fa fa-github"></i></a></ul></div><div class="search" id="js-search"> <input type="text" placeholder="(sitemap)~$ type to search" class="search__input form-control" id="js-search__input"><ul class="search__results" id="js-search__results"></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="/">Home</a><li><a class="about" href="/about/">About Me</a><li><a class="about" href="/projects/">My Projects</a><li><a class="about" href="/feed.xml">XML Feed</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><header class="post-header"><h1 class="post-title">Bypass NAC ( Network Access Control )</h1></header><span class="time">02 Feb 2020</span> <span class="categories"> &raquo; <a href="/category/hacking">hacking</a> </span><div class="content"><div class="post"><p>In this post i’ll describe how to bypass NAC ( Network Access Control ). During an internal pentest, I had a problem connecting to the client network ( all network devices 802.1x (including VoIP devices), after a few hours trying to find out why, I found out that the client had implemented NAC, but what is Network access protocol (NAC) ?<p>Network Access Control (NAC) is a solution used on corporate networks to prevent, or even hinder, unauthorized hosts from accessing internally available services and systems. This access restriction can occur only at the network layer, preventing an IP address from being obtained through the DHCP service, or completely segmenting the wrong hosts from the valid ones at the link layer level. Below are descriptive steps to circumvent NAC, remembering that this does not work in all cases.<p>1º Connect a valid host to hub<p>2º Attach the attacker’s host to the hub<p>3º Intercept the ARP frames to identify the valid host MAC address<p>4º Connect hub / switch to the network point<p>5º Wait for authentication of valid host<p>6º Clone the valid host MAC address into the attacker’s host<p>7º Enter the victim’s IP address statically in the attacker’s host<p>This will allow the attacker to communicate with corporate networks without requiring authentication. The following illustration shows the diagram representing such a bypass of the NAC:<p><img src="/static/images/wireshark.png" alt="wireshark.png" /><p>After setup, wireshark was used to get IP and MAC address from ARP packets. As ilustrate bellow<p><img src="/static/images/wireshark_2.png" alt="wireshark_2.png" /><p>The next step was to clone the victim’s MAC address, IP address, configure network settings, and then connect the attacker’s machine to the hub. The following illustration shows when the required NAC bypass settings are made:<p><img src="/static/images/arp.png" alt="arp.png" /><p>As a proof of concept concept, a scan was performed on the 10.75.X.X/X subnet to find available hosts with the nmap tool. The image below reveals the fact:<p><img src="/static/images/nmap.png" alt="nmap.png" /><p>Thats all folks.. If you would like more posts related to internal pentest, leave your comment at<ul><li><a href="twitter.com/0xrdf">twitter.com/0xrdf</a></ul></div><div class="share-page"> <span style="float: left;">Share this on &rarr;&nbsp;&nbsp;</span> <a href="https://twitter.com/share" class="twitter-share-button" data-via="0xrdf0">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script><div class="g-plus" data-action="share" data-annotation="bubble"></div><script src="https://apis.google.com/js/platform.js" async defer></script><div class="fb-share-button" data-href="https://0xrdf.github.io/hacking/2020/02/02/bypass-nac.html" data-layout="button_count" style="position: relative; top: -8px; left: 3px;"></div></div><div id="fb-root"></div><script>(function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.6&appId="; fjs.parentNode.insertBefore(js, fjs); }(document, 'script', 'facebook-jssdk'));</script></div><div class="panel-body"><h4>Related Posts</h4><ul><li class="relatedPost"> <a href="https://0xrdf.github.io/hacking/2022/06/09/nim-reversing.html">Reversing Nim Binary With Radare</a> (Categories: <a href="/category/hacking">hacking</a>)<li class="relatedPost"> <a href="https://0xrdf.github.io/hacking/2022/03/19/antitamper-ios.html">iOS Anti-Tampers Bypass</a> (Categories: <a href="/category/hacking">hacking</a>)<li class="relatedPost"> <a href="https://0xrdf.github.io/hacking/web/2022/01/20/cve_2022_23046_phpipam.html">SQL Injection CVE-2022-23046 - PHPIPAM + Exploit</a> (Categories: <a href="/category/hacking">hacking</a>, <a href="/category/web">web</a>)<li class="relatedPost"> <a href="https://0xrdf.github.io/hacking/2020/02/02/RCE-FROM-PATHTRAVERSAL.html">RCE using Path Traversal</a> (Categories: <a href="/category/hacking">hacking</a>)</ul></div><div class="PageNavigation"> <a class="prev" href="/hacking/2020/02/02/RCE-FROM-PATHTRAVERSAL.html">&laquo; RCE using Path Traversal</a> <a class="next" href="/hacking/web/2022/01/20/cve_2022_23046_phpipam.html">SQL Injection CVE-2022-23046 - PHPIPAM + Exploit &raquo;</a></div><div class="disqus-comments"><div id="disqus_thread"></div><script type="text/javascript"> /* <![CDATA[ */ var disqus_shortname = ""; var disqus_identifier = "https://0xrdf.github.io_Bypass NAC ( Network Access Control )"; var disqus_title = "Bypass NAC ( Network Access Control )"; /* * * DON'T EDIT BELOW THIS LINE * * */ (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); /* ]]> */ </script></div><footer> &copy; Rodolfo Tavares - <a href="https://github.com/0xrdf">https://github.com/0xrdf</a><div class="btn-github" style="float:right;"> <iframe src="https://ghbtns.com/github-btn.html?user=enovella&repo=enovella.github.io&type=star&count=true" frameborder="0" scrolling="0" width="85" height="20px"></iframe> <iframe src="https://ghbtns.com/github-btn.html?user=enovella&repo=enovella.github.io&type=fork&count=true" frameborder="0" scrolling="0" width="85" height="20px"></iframe></div></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
