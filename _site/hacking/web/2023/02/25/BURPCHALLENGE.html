<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicon.ico" /><title>Making money like magic - Rodolfo Tavares, 0xbaadf00d blog üé©</title><meta name="author" content="Rodolfo Tavares" /><meta name="description" content="Making money like magic" /><meta name="keywords" content="Making money like magic, Rodolfo Tavares, 0xbaadf00d blog üé©, hacking, web" /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="Rodolfo Tavares, 0xbaadf00d blog üé©" property="og:site_name"><meta content="Making money like magic" property="og:title"><meta content="article" property="og:type"><meta content="0xrdf's blog" property="og:description"><meta content="http://localhost:4000/hacking/web/2023/02/25/BURPCHALLENGE.html" property="og:url"><meta content="2023-02-25T10:12:34-03:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.png" property="og:image"><meta content="hacking" property="article:section"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@0xrdf0"><meta name="twitter:creator" content="@0xrdf0"><meta name="twitter:title" content="Making money like magic"><meta name="twitter:url" content="http://localhost:4000/hacking/web/2023/02/25/BURPCHALLENGE.html"><meta name="twitter:description" content="0xrdf's blog"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-XXXXXXXX-Y', 'auto'); ga('send', 'pageview'); </script><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.png" height="75px" width="75px" /></a><h1 class="author-name">Rodolfo Tavares</h1><div class="profile-about"> I am a pentester and mobile security researcher. Also, play CTF's</div><div class="social"><ul><li><a href="https://twitter.com/0xrdf0" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.linkedin.com/in/rodolfo-augusto-543863a/" target="_blank"><i class="fa fa-linkedin"></i></a><li><a href="https://github.com/0xrdf" target="_blank"><i class="fa fa-github"></i></a></ul></div><div class="search" id="js-search"> <input type="text" placeholder="(sitemap)~$ type to search" class="search__input form-control" id="js-search__input"><ul class="search__results" id="js-search__results"></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="/">Home</a><li><a class="about" href="/about/">About Me</a><li><a class="about" href="/projects/">My Projects</a><li><a class="about" href="/feed.xml">XML Feed</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><header class="post-header"><h1 class="post-title">Making money like magic</h1></header><span class="time">25 Feb 2023</span> <span class="categories"> &raquo; <a href="/category/hacking">hacking</a>, <a href="/category/web">web</a> </span><div class="content"><div class="post"><p>Hi, all ‚úä<p>In this blog I will try to explain a bug, which I found during my studies, using <a href="https://twitter.com/WebSecAcademy">https://twitter.com/WebSecAcademy</a> ( PortSwigger ) challenge <a href="https://twitter.com/WebSecAcademy/status/1627712571091431424">https://twitter.com/WebSecAcademy/status/1627712571091431424</a>. If you are not yet familiar with their work, I highly recommend their labs and especially the book ( holy grail of web hacking ) - The Web Application Hacker‚Äôs Handbook: Finding and Exploiting Security Flaws Authors: Dafydd Stuttard, Marcus Pinto.<p>tl;dr<p>For those who don‚Äôt have patience, the bug is race condition between a financial transaction using peer to peer, so basically, I can ‚Äúmake‚Äù money.<p>-&gt; I will not disclose the names of the target due to program policy.<p>First, if you don‚Äôt know what a peer to peer transaction is, I recommend a quick read, here <a href="https://en.wikipedia.org/wiki/Peer-to-peer_transaction">https://en.wikipedia.org/wiki/Peer-to-peer_transaction</a>. Generally, this functionality is used when you have an account at bank A, and you transfer money to another person who also has an account at bank A. But what is it for? generally, this ‚Äútransactional‚Äù peer to peer is used to make the transaction ‚Äúfaster‚Äù between users of the same bank (as far as I know, I could be wrong). So the next step was to make a request for another user who have an account at the same bank as me (My friend fx0).<p>The following request shows <strong>my</strong> account balance before the attack:<p><img src="/static/images/my_balance_01.png" alt="" /><p>Then the following request illustrates my friend‚Äôs bank balance:<p><img src="/static/images/friend_balance.png" alt="friend_balance.png" /><p>The next test was to send a minimum amount to my friend, the following request illustrates the fact:<p><img src="/static/images/req_amount.png" alt="req_amount.png" /><p>To prove that there was indeed a transfer, the following images illustrate the balance of the accounts:<ul><li>My account:</ul><p><img src="/static/images/my_balance_after.png" alt="my_balance_after.png" /><ul><li>FX Account:</ul><p><img src="/static/images/fxo_balance.png" alt="fxo_balance.png" /><p>One of the techniques i learned doing the labs <a href="https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-infinite-money">https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-infinite-money</a> is that you can generate null payloads in the intruder, to test a functionality, or request, usually the null payload is used for a variety of attacks, for example, harvesting cookies for sequencing analysis, application-layer denial-of-service attacks where requests are repeatedly sent which initiate high-workload tasks on the server, or keeping alive a session token that is being used in other intermittent tests or in that case <strong>race conditions</strong>, if you dont know what is race conditions üëâ <a href="https://book.hacktricks.xyz/pentesting-web/race-condition">https://book.hacktricks.xyz/pentesting-web/race-condition</a> and start the lab at portswigger academy üëâ <a href="https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-race-condition">https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-race-condition</a>. The next step was to configure the intruder to perform the race condition attack.<p><img src="/static/images/race_05.png" alt="race_05.png" /><p>This attack can also be used, using the turbo intruder. Check the blog üëâ <a href="https://portswigger.net/research/turbo-intruder-embracing-the-billion-request-attack">https://portswigger.net/research/turbo-intruder-embracing-the-billion-request-attack</a><p>The next image illustrates the attack using the previously used configurations. Some requests were accepted, using the same transactional request, also note that other Transactions and payment UUIDs were generated:<p><img src="/static/images/intruder_req_07.png" alt="intruder_req_07.png" /><p>As can be seen in the previous image, 9 requests were approved, out of 100. So, in practice, I would have to have a balance of 0.00 in my account, and my friend would have to have 0.10. However, to my surprise, 0.09 was not withdrawn from my account, but only 0.03. And my friend won 0.09, that is, we make money like üßô‚Äç‚ôÇÔ∏è ‚ú® (in fact, he would be rich and I would be poor hahaha).<p>The following images illustrate account balances after the attack:<ul><li>My account:</ul><p><img src="/static/images/final_01.png" alt="final_01.png" /><ul><li>FX account:</ul><p><img src="/static/images/final_02.png" alt="final_02.png" /><p>And in the end, the cents turned into bountys.<p><img src="/static/images/bb.png" alt="bb.png" /><p>A few notes, the devices UUID was used to bypass some application protections, to access my account and my friend‚Äôs account. The X-Mobile header had to be spoofed.<p>But that‚Äôs it. I hope I have contributed a little.</div><div class="share-page"> <span style="float: left;">Share this on &rarr;&nbsp;&nbsp;</span> <a href="https://twitter.com/share" class="twitter-share-button" data-via="0xrdf0">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script><div class="g-plus" data-action="share" data-annotation="bubble"></div><script src="https://apis.google.com/js/platform.js" async defer></script><div class="fb-share-button" data-href="http://localhost:4000/hacking/web/2023/02/25/BURPCHALLENGE.html" data-layout="button_count" style="position: relative; top: -8px; left: 3px;"></div></div><div id="fb-root"></div><script>(function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.6&appId="; fjs.parentNode.insertBefore(js, fjs); }(document, 'script', 'facebook-jssdk'));</script></div><div class="panel-body"><h4>Related Posts</h4><ul><li class="relatedPost"> <a href="http://localhost:4000/hacking/2022/06/09/nim-reversing.html">Reversing Nim Binary With Radare</a> (Categories: <a href="/category/hacking">hacking</a>)<li class="relatedPost"> <a href="http://localhost:4000/hacking/2022/03/19/antitamper-ios.html">iOS Anti-Tampers Bypass</a> (Categories: <a href="/category/hacking">hacking</a>)<li class="relatedPost"> <a href="http://localhost:4000/hacking/web/2022/01/20/cve_2022_23046_phpipam.html">SQL Injection CVE-2022-23046 - PHPIPAM + Exploit</a> (Categories: <a href="/category/hacking">hacking</a>, <a href="/category/web">web</a>)<li class="relatedPost"> <a href="http://localhost:4000/hacking/2020/02/02/bypass-nac.html">Bypass NAC ( Network Access Control )</a> (Categories: <a href="/category/hacking">hacking</a>)<li class="relatedPost"> <a href="http://localhost:4000/hacking/2020/02/02/RCE-FROM-PATHTRAVERSAL.html">RCE using Path Traversal</a> (Categories: <a href="/category/hacking">hacking</a>)</ul></div><div class="PageNavigation"> <a class="prev" href="/hacking/2022/06/09/nim-reversing.html">&laquo; Reversing Nim Binary With Radare</a></div><div class="disqus-comments"><div id="disqus_thread"></div><script type="text/javascript"> /* <![CDATA[ */ var disqus_shortname = ""; var disqus_identifier = "http://localhost:4000_Making money like magic"; var disqus_title = "Making money like magic"; /* * * DON'T EDIT BELOW THIS LINE * * */ (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); /* ]]> */ </script></div><footer> &copy; Rodolfo Tavares - <a href="https://github.com/0xrdf">https://github.com/0xrdf</a><div class="btn-github" style="float:right;"> <iframe src="https://ghbtns.com/github-btn.html?user=0xrdf&repo=0xrdf.github.io&type=star&count=true" frameborder="0" scrolling="0" width="85" height="20px"></iframe> <iframe src="https://ghbtns.com/github-btn.html?user=0xrdf&repo=0xrdf.github.io&type=fork&count=true" frameborder="0" scrolling="0" width="85" height="20px"></iframe></div></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
